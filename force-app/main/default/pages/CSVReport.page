<apex:page controller="CSVReportEngine" contentType="text/csv#{!FileName}_{!today()}.csv" >{!ColumnHeaders}<apex:repeat value="{!ReportData}" var="data">{!newLine}<apex:repeat value="{!Fields}" var="fld"><apex:outputText value="," rendered="{!fld.Id != Fields[0].Id}"/><apex:outputText rendered="{!and(and(!fld.IsDate__c,!fld.IsInteger__c),fld.Aggregation__c='GROUP BY')}">"</apex:outputText><apex:outputText value="{!substitute(data[fld.Id],substitute($Label.linebreak, '-', ''),', ')}" rendered="{!and(and(!fld.IsDate__c,!fld.IsInteger__c),fld.Aggregation__c='GROUP BY')}"/><apex:outputText value="{!data[fld.Id]}" rendered="{!and(and(!fld.IsDate__c,!fld.IsInteger__c),fld.Aggregation__c != 'GROUP BY')}"/><apex:outputText value="{0,date,dd.MM.yyyy}" rendered="{!fld.IsDate__c}"><apex:param value="{!data[fld.Id]}"/></apex:outputText><apex:outputText value="{0,number,0}" rendered="{!fld.IsInteger__c}"><apex:param value="{!data[fld.Id]}"/></apex:outputText><apex:outputText rendered="{!and(and(!fld.IsDate__c,!fld.IsInteger__c),fld.Aggregation__c='GROUP BY')}">"</apex:outputText></apex:repeat></apex:repeat></apex:page>