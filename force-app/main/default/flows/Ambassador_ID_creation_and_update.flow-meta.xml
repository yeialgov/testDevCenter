<?xml version="1.0" encoding="UTF-8"?>
<Flow xmlns="http://soap.sforce.com/2006/04/metadata">
    <apiVersion>49.0</apiVersion>
    <assignments>
        <description>Assignment step used to define the existent ambassador as a reference</description>
        <name>Reference_Ambassador_contact</name>
        <label>Reference Ambassador contact</label>
        <locationX>635</locationX>
        <locationY>328</locationY>
        <assignmentItems>
            <assignToReference>ContactId</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Get_all_contacts_that_have_an_ambassador_ID</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Existent_Ambassador_details_conflict_with_new_Ambassador_details</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Reference_unique_contact_with_email_equal_to_new_ambassador_ID</name>
        <label>Reference unique contact with email equal to new ambassador ID</label>
        <locationX>1097</locationX>
        <locationY>584</locationY>
        <assignmentItems>
            <assignToReference>ContactId</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Get_the_unique_contact_with_email_equal_to_the_new_ambassador_ID</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Feed_the_ambassador_ID_into_the_existent_contact</targetReference>
        </connector>
    </assignments>
    <assignments>
        <description>Sets N/A for Last Name</description>
        <name>Set_Last_Name</name>
        <label>Set Last Name</label>
        <locationX>1665</locationX>
        <locationY>256</locationY>
        <assignmentItems>
            <assignToReference>NewAmbassadorLName</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>N/A</stringValue>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Create_Floating_contact</targetReference>
        </connector>
    </assignments>
    <decisions>
        <description>Was conflicting Name/Phone info provided?</description>
        <name>Existent_Ambassador_details_conflict_with_new_Ambassador_details</name>
        <label>Existent Ambassador details conflict with new Ambassador details?</label>
        <locationX>631</locationX>
        <locationY>585</locationY>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>No_new_info</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>NewAmbassadorFName</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue></stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>NewAmbassadorLName</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue></stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>NewAmbassadorPhone</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue></stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Feed_the_lookup_field_on_the_Lead_to_the_contact</targetReference>
            </connector>
            <label>No new info</label>
        </rules>
        <rules>
            <name>No_Conflict</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>ContactId.FirstName</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <elementReference>NewAmbassadorFName</elementReference>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>ContactId.LastName</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <elementReference>NewAmbassadorLName</elementReference>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>ContactId.Phone</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <elementReference>NewAmbassadorPhone</elementReference>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Feed_the_lookup_field_on_the_Lead_to_the_contact</targetReference>
            </connector>
            <label>No Conflict</label>
        </rules>
        <rules>
            <name>Conflict</name>
            <conditionLogic>or</conditionLogic>
            <conditions>
                <leftValueReference>ContactId.FirstName</leftValueReference>
                <operator>NotEqualTo</operator>
                <rightValue>
                    <elementReference>NewAmbassadorFName</elementReference>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>ContactId.LastName</leftValueReference>
                <operator>NotEqualTo</operator>
                <rightValue>
                    <elementReference>NewAmbassadorLName</elementReference>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>ContactId.Phone</leftValueReference>
                <operator>NotEqualTo</operator>
                <rightValue>
                    <elementReference>NewAmbassadorPhone</elementReference>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Update_existent_contact</targetReference>
            </connector>
            <label>Conflict</label>
        </rules>
    </decisions>
    <decisions>
        <description>Does any contact have this email address as an Ambassador ID?</description>
        <name>Is_an_existent_Ambassador_ID</name>
        <label>Is an existent Ambassador ID?</label>
        <locationX>628</locationX>
        <locationY>63</locationY>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>Not_an_existent_Ambassador_ID</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>Get_all_contacts_that_have_an_ambassador_ID</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Get_contacts_which_email_is_similar_to_the_new_Ambassador_ID</targetReference>
            </connector>
            <label>Not an existent Ambassador ID</label>
        </rules>
        <rules>
            <name>Existent_ambassador_ID</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>Get_all_contacts_that_have_an_ambassador_ID</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Reference_Ambassador_contact</targetReference>
            </connector>
            <label>Existent ambassador ID</label>
        </rules>
    </decisions>
    <decisions>
        <description>Do any Contacts have this email address as their official contact email?</description>
        <name>Is_an_existent_customer</name>
        <label>Is an existent customer?</label>
        <locationX>1322</locationX>
        <locationY>56</locationY>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>Not_an_existent_customer</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>Get_contacts_which_email_is_similar_to_the_new_Ambassador_ID</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Last_Name_NULL</targetReference>
            </connector>
            <label>Not an existent customer</label>
        </rules>
        <rules>
            <name>Existent_Customer</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>Get_contacts_which_email_is_similar_to_the_new_Ambassador_ID</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Get_the_unique_contact_with_email_equal_to_the_new_ambassador_ID</targetReference>
            </connector>
            <label>Existent Customer</label>
        </rules>
    </decisions>
    <decisions>
        <name>Last_Name_NULL</name>
        <label>Last Name NULL</label>
        <locationX>1547</locationX>
        <locationY>63</locationY>
        <defaultConnector>
            <targetReference>Create_Floating_contact</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>Last_Name_is_Null</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>NewAmbassadorLName</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue></stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Set_Last_Name</targetReference>
            </connector>
            <label>Last Name is Null</label>
        </rules>
    </decisions>
    <interviewLabel>Ambassador ID creation and update {!$Flow.CurrentDateTime}</interviewLabel>
    <label>Ambassador ID creation and update</label>
    <processMetadataValues>
        <name>BuilderType</name>
        <value>
            <stringValue>LightningFlowBuilder</stringValue>
        </value>
    </processMetadataValues>
    <processMetadataValues>
        <name>OriginBuilderType</name>
        <value>
            <stringValue>LightningFlowBuilder</stringValue>
        </value>
    </processMetadataValues>
    <processType>AutoLaunchedFlow</processType>
    <recordCreates>
        <description>Linked to an Unassociated Ambassador Account</description>
        <name>Create_Floating_contact</name>
        <label>Create Floating contact</label>
        <locationX>1783</locationX>
        <locationY>59</locationY>
        <assignRecordIdToReference>FloatingContactId</assignRecordIdToReference>
        <connector>
            <targetReference>Feed_the_lead_with_the_new_ambassador_ID</targetReference>
        </connector>
        <inputAssignments>
            <field>AccountId</field>
            <value>
                <stringValue>0011t000018q0ahAAA</stringValue>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Ambassador_ID__c</field>
            <value>
                <elementReference>NewAmbassadorID</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Email</field>
            <value>
                <elementReference>NewAmbassadorID</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>FirstName</field>
            <value>
                <elementReference>NewAmbassadorFName</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>LastName</field>
            <value>
                <elementReference>NewAmbassadorLName</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Phone</field>
            <value>
                <elementReference>NewAmbassadorPhone</elementReference>
            </value>
        </inputAssignments>
        <object>Contact</object>
    </recordCreates>
    <recordLookups>
        <description>Checks if there already is a contact with the provided ambassador ID</description>
        <name>Get_all_contacts_that_have_an_ambassador_ID</name>
        <label>Get contact with this ambassador ID</label>
        <locationX>466</locationX>
        <locationY>57</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Is_an_existent_Ambassador_ID</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Ambassador_ID__c</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>NewAmbassadorID</elementReference>
            </value>
        </filters>
        <getFirstRecordOnly>true</getFirstRecordOnly>
        <object>Contact</object>
        <queriedFields>Id</queriedFields>
        <queriedFields>Ambassador_ID__c</queriedFields>
        <queriedFields>FirstName</queriedFields>
        <queriedFields>LastName</queriedFields>
        <queriedFields>Phone</queriedFields>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordLookups>
        <description>Do any Contacts  have this email address as their official contact email?</description>
        <name>Get_contacts_which_email_is_similar_to_the_new_Ambassador_ID</name>
        <label>Get contacts which email is similar to the new Ambassador ID</label>
        <locationX>1020</locationX>
        <locationY>52</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Is_an_existent_customer</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Ambassador_ID__c</field>
            <operator>EqualTo</operator>
            <value>
                <stringValue></stringValue>
            </value>
        </filters>
        <filters>
            <field>Email</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>NewAmbassadorID</elementReference>
            </value>
        </filters>
        <filters>
            <field>FirstName</field>
            <operator>NotEqualTo</operator>
            <value>
                <stringValue>MyOrderbird</stringValue>
            </value>
        </filters>
        <getFirstRecordOnly>false</getFirstRecordOnly>
        <object>Contact</object>
        <queriedFields>Id</queriedFields>
        <queriedFields>Email</queriedFields>
        <queriedFields>FirstName</queriedFields>
        <queriedFields>LastName</queriedFields>
        <queriedFields>Phone</queriedFields>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordLookups>
        <description>Whether there is one contact with a similar email address or more than one, the flow will pick up one of them and update it and link it to the lead.
The sorting method of the found contacts will be defined later.</description>
        <name>Get_the_unique_contact_with_email_equal_to_the_new_ambassador_ID</name>
        <label>Get one of the contacts with email equal to the new ambassador ID</label>
        <locationX>1331</locationX>
        <locationY>584</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Reference_unique_contact_with_email_equal_to_new_ambassador_ID</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Ambassador_ID__c</field>
            <operator>EqualTo</operator>
            <value>
                <stringValue></stringValue>
            </value>
        </filters>
        <filters>
            <field>Email</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>NewAmbassadorID</elementReference>
            </value>
        </filters>
        <getFirstRecordOnly>true</getFirstRecordOnly>
        <object>Contact</object>
        <queriedFields>Id</queriedFields>
        <queriedFields>FirstName</queriedFields>
        <queriedFields>LastName</queriedFields>
        <queriedFields>Phone</queriedFields>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordUpdates>
        <name>Feed_the_ambassador_ID_into_the_existent_contact</name>
        <label>Feed the ambassador ID into the existent contact</label>
        <locationX>912</locationX>
        <locationY>584</locationY>
        <connector>
            <targetReference>Existent_Ambassador_details_conflict_with_new_Ambassador_details</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Id</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>Get_the_unique_contact_with_email_equal_to_the_new_ambassador_ID.Id</elementReference>
            </value>
        </filters>
        <inputAssignments>
            <field>Ambassador_ID__c</field>
            <value>
                <elementReference>NewAmbassadorID</elementReference>
            </value>
        </inputAssignments>
        <object>Contact</object>
    </recordUpdates>
    <recordUpdates>
        <name>Feed_the_lead_with_the_new_ambassador_ID</name>
        <label>Feed the lead with the new ambassador ID</label>
        <locationX>1958</locationX>
        <locationY>59</locationY>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Ambassador_ID__c</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>NewAmbassadorID</elementReference>
            </value>
        </filters>
        <inputAssignments>
            <field>ReferralContact__c</field>
            <value>
                <elementReference>FloatingContactId</elementReference>
            </value>
        </inputAssignments>
        <object>Lead</object>
    </recordUpdates>
    <recordUpdates>
        <name>Feed_the_lookup_field_on_the_Lead_to_the_contact</name>
        <label>Feed the lookup field on the Lead to the existent contact</label>
        <locationX>301</locationX>
        <locationY>596</locationY>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Ambassador_ID__c</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>NewAmbassadorID</elementReference>
            </value>
        </filters>
        <inputAssignments>
            <field>ReferralContact__c</field>
            <value>
                <elementReference>ContactId.Id</elementReference>
            </value>
        </inputAssignments>
        <object>Lead</object>
    </recordUpdates>
    <recordUpdates>
        <name>Update_existent_contact</name>
        <label>Update existent contact</label>
        <locationX>635</locationX>
        <locationY>822</locationY>
        <connector>
            <targetReference>Feed_the_lookup_field_on_the_Lead_to_the_contact</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Id</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>ContactId.Id</elementReference>
            </value>
        </filters>
        <inputAssignments>
            <field>Ambassador_ID__c</field>
            <value>
                <elementReference>NewAmbassadorID</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Most_Recent_Ambassador_F_Name__c</field>
            <value>
                <elementReference>NewAmbassadorFName</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Most_Recent_Ambassador_L_Name__c</field>
            <value>
                <elementReference>NewAmbassadorLName</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Most_Recent_Ambassador_Phone__c</field>
            <value>
                <elementReference>NewAmbassadorPhone</elementReference>
            </value>
        </inputAssignments>
        <object>Contact</object>
    </recordUpdates>
    <start>
        <locationX>126</locationX>
        <locationY>60</locationY>
        <connector>
            <targetReference>Get_all_contacts_that_have_an_ambassador_ID</targetReference>
        </connector>
    </start>
    <status>Active</status>
    <variables>
        <name>ContactId</name>
        <dataType>SObject</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>Contact</objectType>
    </variables>
    <variables>
        <name>Contactswithsimilaremail</name>
        <dataType>SObject</dataType>
        <isCollection>false</isCollection>
        <isInput>true</isInput>
        <isOutput>true</isOutput>
        <objectType>Contact</objectType>
    </variables>
    <variables>
        <name>FloatingContactId</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>true</isInput>
        <isOutput>true</isOutput>
    </variables>
    <variables>
        <name>LeadID</name>
        <dataType>SObject</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>Lead</objectType>
    </variables>
    <variables>
        <name>Loopcounter</name>
        <dataType>Number</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <scale>2</scale>
        <value>
            <numberValue>0.0</numberValue>
        </value>
    </variables>
    <variables>
        <name>LoopVarSameEmail</name>
        <dataType>SObject</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>Contact</objectType>
    </variables>
    <variables>
        <name>NewAmbassadorFName</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>true</isInput>
        <isOutput>true</isOutput>
    </variables>
    <variables>
        <description>The ambassador ID (email) that is belongs to the newly created Lead</description>
        <name>NewAmbassadorID</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>true</isInput>
        <isOutput>true</isOutput>
    </variables>
    <variables>
        <name>NewAmbassadorLName</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>true</isInput>
        <isOutput>true</isOutput>
    </variables>
    <variables>
        <name>NewAmbassadorPhone</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>true</isInput>
        <isOutput>true</isOutput>
    </variables>
</Flow>
